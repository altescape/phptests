<?php
/**
 * Created by JetBrains PhpStorm.
 * User: michaelwatts
 * Date: 19/04/2013
 * Time: 09:32
 * To change this template use File | Settings | File Templates.
 */

$filename ="excelreport.xls";
$contents = "Number \t Charity Name \t Contact Name \t Address \t Telephone \t Email \t Website \t Full details \n";
header('Content-type: application/vnd.ms-excel');
header('Content-Disposition: attachment; filename='.$filename);
echo $contents;

// Defining the basic cURL function
function curl($url) {
    // Assigning cURL options to an array
    $options = Array(
        CURLOPT_RETURNTRANSFER => TRUE,  // Setting cURL's option to return the webpage data
        CURLOPT_FOLLOWLOCATION => TRUE,  // Setting cURL to follow 'location' HTTP headers
        CURLOPT_AUTOREFERER => TRUE, // Automatically set the referer where following 'location' HTTP headers
        CURLOPT_CONNECTTIMEOUT => 120,   // Setting the amount of time (in seconds) before the request times out
        CURLOPT_TIMEOUT => 120,  // Setting the maximum amount of time for cURL to execute queries
        CURLOPT_MAXREDIRS => 10, // Setting the maximum number of redirections to follow
        CURLOPT_USERAGENT => "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.1a2pre) Gecko/2008073000 Shredder/3.0a2pre ThunderBrowse/3.2.1.8",  // Setting the useragent
        CURLOPT_URL => $url, // Setting cURL's URL option with the $url variable passed into the function
    );

    $ch = curl_init();  // Initialising cURL
    curl_setopt_array($ch, $options);   // Setting cURL's options using the previously assigned array data in $options
    $data = curl_exec($ch); // Executing the cURL request and assigning the returned data to the $data variable
    curl_close($ch);    // Closing cURL
    return $data;   // Returning the data from the function
}

// Defining the basic scraping function
function scrape_between($data, $start, $end){
    $data = stristr($data, $start); // Stripping all data from before $start
    $data = substr($data, strlen($start));  // Stripping $start
    $stop = stripos($data, $end);   // Getting the position of the $end of the data to scrape
    $data = substr($data, 0, $stop);    // Stripping all data from after and including the $end of the data to scrape
    return $data;   // Returning the scraped data from the function
}

//$char_number = $_GET["cn"];

// get numbers from url query string
$char_numbers = parse_url($_SERVER['REQUEST_URI'], PHP_URL_QUERY);
// push numbers into array split by comma
// can change this to an actual array of the numbers later just use
/*
 * $char_numbers_arr = [311997,312008,312010];
 */
//$char_numbers_arr = explode(',',$char_numbers); // Get list of charities and store in array, so we can use to cycle through them
//$char_numbers_arr = [311997,312008,312010];

// $char_string = "234520,234473,234518,234520"; /* TESTING */
// SET 1
// $char_string = "234343,234434,234436,234473,234518,234520,234556,234558,234714,234880,234887,235245,235342,235351,235354,235354,235434,235459,235468,235652,235668,235686,235703,235822,235825,236464,236464,236586,236590,236590,236627,236803,236848,236852,237005,237340,237623,237696,237725,237760,237778,237829,237902,237911,237911,238043,238045,238168,238230,238372,238426,238436,239281,239285,239863,239904,239966,239992,240424,240531,240562,240702,240833,241048,241083,241433,241434,241527,241743,241990,241990,242266,242380,242451,242451,242452,242552,242575,242649,242715,242977,243017,243044,243044,243134,243312,243410,243877,243968,244067,244108,244519,244533,244708,244823,244866,244976,245456,245644,245661,245668,245700,245861,246186,246329,246460,246871,247081,247186,247233,247257,247257,247331,247331,247358,247647,247662,247773,247778,247828,247858,247919,247954,248192,248198,248226,248245,248268,248287,248330,248470,248502,248680,248708,248767,248833,248887,248919,248968,249002,249100,249148,249169,249256,249276,249276,249315,249318,249338,249339,249349,249355,249359,249398,249403,249404,249424,249505,249515,249635,249678,249678,249685,249740,249748,249767,249798,249810,249860,249892,249972,249986,250016,250016,250037,250058,250143,250187,250187,250216,250275,250277,250306,250312,250397,250397,250456,250523,250536,250569,250605,250607,250658,250837,250840,250851,250851,250926,251021,251051,251211,251232,251233,251234,251262,251403,251534,251549,251549,251550,251550,251681,251765,251782,251888,251926,251977,251983,251988,252041,252041,252157,252165,252370,252660,252660,252726,252878,252892,253206,253242,253351,253481,253606,253669,253894,254025,254025,254140,254312,254402,254543,254591,254623,254642,254642,254807,254937,254951,255030,255095,255249,255281,255420,255424,255460,255650,255685,255695,255913,256356,256391,256618,256756,256789,256893,256979,257210,257237,257318,257343,257345,257376,257376,257516,257551,257857,257912,258085,258197,258224,258322,258390,258421,258474,258489,258583,258583,258612,258713,258815,258825,259140,259334,259358,259358,259480,259558,259649,259649,259678,259736,259892,260015,260059,260189,260666,261009,261009,261017,261035,261096,261192,261245,261307,261347,261359,261383,261430,261476,261488,261645,261645,261726,261726,261793,261898,261926,262158,262191,262259,262270,262334,262481,262548,262777,262785,262859,262865,262870,262933,262937,262966,263133,263147,263198,263207,263446,263446,263515,263617,263710,263894,263954,263960,264014,264017,264017,264078,264078,264133,264140,264166,264166,264289,264299,264501,264506,264529,264621,264636,264658,264713,264728,264809,264809,264818,264818,264839,264873,264927,265008,265090,265103,265103,265139,265192,265239,265249,265394,265464,265543,265647,265656,265755,265828,266128,266130,266192,266202,266220,266260,266318,266518,266620,266633,266633,266780,266813,266916,266983,267021,267037,267043,267116,267174,267234,267426,267444,267469,267516,267618,267781,267917,267965,267984,268154,268218,268354,268369,268468,268482,268502,268502,268639,268876,269123,269158,269167,269177,269181,269264,269275,269425,269433,269615,269640,269645,269665,269667,269668,269668,269830,269936,269971,270060,270080,270129,270143,270147,270156,270157,270158,270194,270288,270302,270302,270525,270659,270757,270822,270860,270864,270901,270923,270957,271012,271028,271117,271160,271297,271323,271370,271483,271519,271547,271665,271729,271731,271833,271907,271922,272050,272056,272071,272099,272279,272307,272384,272389,272464,272465,272505,272616,272619,272663,272671,272761,272905,272926,272931,273015,273071,273136,273147,273150,273208,273298,273424,273424,273425,273434,273449,273562,273571,273586,273586,273589,273596,273596,273615,273724,273793,273795,273860,273924,274040,274100,274145,274166,274206,274222,274260,274345,274369,274373,274403,274467,274467,274605,274605,274664,274695,274737,274769,274864,275048,275061,275119,275261,275383,275386,275433,275454,275489,275489,275689,275745,275745,275796,275913,275919,275936,275961,276035,276172,276172,276250,276251,276286,276286,276441,276484,276669,276677,276784,276892,276892,276940,276943,276957,276960,276976,276996,276997,277052,277074,277074,277077,277128,277221,277275,277318,277324,277424,277439,277503,277570,277570,277723,277747,277810,277810,277833,277844,277981,277992,278072,278104,278136,278140,278173,278301,278387,278449,278508,278518,278627,278720,278742,278746,278760,278823,278861,278950,278973,278979,278979,279057,279184,279184,279267,279354,279473,279476,279567,279579,279652,279756,279859,279859,279884,280048,280093,280229,280276,280339,280392,280422,280577,280626,280681,280688,280698,280707,280795,280825,280852,280859,280883,280918,280919,280956,280960,280977,281074,281213,281222,281242,281242,281276,281307,281325,281362,281371,281420,281420,281566,281571,281680,281681,281686,281730,281797,281820,281836,281836,281859,281929,281936,281942,281943,281963,281991,282102,282167,282197,282264,282264,282270,282303,282305,282336,282358,282409,282464,282558,282558,282723,282729,282729,282847,282857,282921,283024,283065,283302,283322,283329,283329,283397,283484,283556,283556,283564,283564,283627,283660,283686,283708,283813,283877,283895,283920,283944,283945,284016,284077,284188,284260,284260,284262,284406,284416,284545,284555,284589,284670,284701,284789,284839,284880,284881,284907,284912,284923,284934,284957,284957,284967,285162,285174,285214,285244,285251,285287,285300,285398,285543,285575,285575,285627,285696,285766,285776,285836,285891,285908,285917,285987,285987,286059,286084,286142,286173,286231,286238,286347,286360,286384,286434,286434,286447,286554,286554,286575,286628,286650,286818,286863,286876,286892,286909,286909,286967,287037,287077,287120,287144,287232,287282,287287,287322,287401,287579,287579,287610,287694,287773,287779,287780,287785,287786,287815,287848,287868,287894,287936,288007,288018,288023,288080,288117,288125,288141,288148,288148,288158,288271,288285,288356,288371,288379,288379,288404,288417,288462,288465,288467,288527,288595,288595,288622,288630,288675,288701,288887,288931,289048,289066,289145,289154,289243,289294,289372,289430,289466,289581,289600,289717,289850,289868,290011,290059,290059,290069,290112,290118,290118,290143,290173,290180,290218,290261,290286,290302,290302,290350,290448,290456,290458,290462,290511,290511,290533,290535,290544,290598,290599,290647,290767,290772,290833,290866,290874,290883,290927,290992,291143,291222,291245,291360,291391,291391,291460,291489,291489,291558,291583,291662,291691,291691,291714,291796,291824,291824,291834,291955,292027,292048,292058,292082,292101,292110,292180,292182,292320,292357,292357,292411,292469,292497,292506,292506,292517,292518,292537,292537,292552,292552,292664,292683,292697,292708,292758,292786,292824,292841,292841,292845,292880,292886,292897,292976,293027,293033,293072,293074,293141,293188,293232,293355,293358,293360,293377,293417,293446,293459,293464,293466,293522,293546,293575,293623,293705,293721,293787,293851,293959,293968,294085,294220,294222,294229,294230,294282,294329,294344,294354,294377,294387,294494,294540,294555,294582,294670,294745,294807,294832,294841,294860,294860,294924,294944,294944,295003,295072,295107,295145,295154,295154,295157,295175,295178,295192,295197,295224,295237,295242,295257,295260,295263,295314,295329,295346,295355,295393,295399,295449,295595,295598,295672,295716,295785,295790,295808,295808,295818,295873,295981,296030,296042,296058,296065,296072,296097,296219,296311,296311,296375,296453,296454,296491,296531,296572,296588,296590,296590,296645,296661,296661,296691,296694,296834,296862,297013,297099,297106,297107,297114,297114,297126,297241,297359,297359,297366,297370,297483,297489,297489,297496,297540,297580,297630,297631,297656,297716,297798,297806,297847,297877,297937,298028,298045,298074,298096,298104,298140,298149,298155,298164,298166,298175,298316,298348,298348,298359,298361,298368,298388,298405,298522,298542,298555,298582,298603,298603,298609,298627,298723,298723,298729,298740,298807,298809,298830,298851,298863,298867,298869,298900,298909,298909,298910,298951,298970,299049,299081,299106,299123,299128,299186,299248,299342,299342,299400,299411,299438,299450,299509,299522,299535,299615,299679,299686,299687,299690,299717,299731,299745,299758,299789,299872,299889,299901,299935,299988,300105,300923,301328,301731,302498,302606,302925,302925,302963,303167,303167,303187,303199,303324,305034,305034,305695,305962,305968,305969,305991,305992,305999,306016,306034,306034,306054,306065,306065,306070,306075,306077,306080,306083,306087,306096,306101,306122,306125,306134,306137,306137,306153,306210,306214,306218,306222,306288,306289,306315,306316,306318,306338,306371,306576,306577,306577,306622,306694,306709,306710,306712,306716,306945,306948,306975,306983,306987,306998,307001,307002,307003,307005,307006,307014,307019,307021,307023,307024,307027,307034,307035,307038,307043,307045,307046,307048,307050,307061,307063,307066,307071,307072,307099,307104,307286,307286,307287,307299,307320,307322,307324,307325,307328,307330,307331,307332,307335,307339,307340,307340,307341,307342,307343,307346,307346,307347,307368,307368,307370,307372,307374,307379,307409,307425,307426,307427,307530,307530,307531,307534,307793,307844,307852,307854,307856,307889,307892,307894,307907,307914,307915,307916,307917,307920,307921,307923,307925,307931,307935,307937,307942,307992,308189,309047,309085,309086,309087,309088,309089,309090,309093,309094,309095,309096,309098,309099,309100,309101,309103,309105,309108,309109,309112,309115,309144,309147,309148,309243,309266,309267,309268,309481,309482,309482,309486,309488,309489,309489,309490,309501,309565,309566,309639,309640,309642,309643,309648,309650,309651,309651,309657,309659,309676,309678,309681,309683,309684,309685,309693,309698,309701,309703,309710,309714,309720,309910,309911,309912,309917,309921,309925,309939,309998,310007,310013,310018,310024,310033,310208,310212,310214,310218,310257,310268,310278,310279,310281,310283,310288,310481,310482,310483,310486,310487,310490,310491,310493,310630,310630,310631,310633,310634,310635,310637,310638,310639,310640,310642,310644,310864,310864,310865,310870,310871,310876,310916,310916,310930,311027,311028,311050,311053,311054,311057,311059,311060,311061,311061,311062,311064,311065,311068,311069,311070,311073,311075,311076,311079,311083,311087,311096,311263,311270,311272,311272,311273,311274,311280,311293,311326,311436,311445,311449,311456,311504,311585,311697,311707,311711,311713,311714,311715,311716,311719";
// SET 2
//$char_string = "1095134,1095190,1095197,1095214,1095215,1095234,1095268,1095294,1095308,1095322,1095322,1095326,1095328,1095388,1095435,1095446,1095460,1095478,1095618,1095618,1095623,1095666,1095731,1095748,1095749,1095796,1095809,1095856,1095897,1095940,1096111,1096112,1096130,1096185,1096193,1096193,1096222,1096244,1096270,1096300,1096364,1096389,1096473,1096479,1096526,1096538,1096543,1096567,1096584,1096662,1096701,1096721,1096727,1096779,1096790,1096796,1096829,1096892,1097110,1097174,1097217,1097231,1097271,1097333,1097339,1097388,1097409,1097482,1097542,1097545,1097596,1097608,1097614,1097631,1097682,1097691,1097737,1097737,1097781,1097842,1097899,1097899,1097940,1097977,1097984,1098106,1098126,1098136,1098164,1098164,1098206,1098235,1098236,1098294,1098336,1098410,1098422,1098506,1098520,1098529,1098537,1098586,1098586,1098657,1098673,1098704,1098728,1098740,1098744,1098766,1098874,1098900,1098940,1099015,1099020,1099027,1099051,1099051,1099052,1099052,1099060,1099106,1099143,1099148,1099202,1099331,1099366,1099386,1099412,1099446,1099506,1099506,1099530,1099567,1099585,1099629,1099660,1099660,1099682,1099682,1099698,1099709,1099725,1099776,1099782,1099806,1099823,1099878,1099889,1099941,1099954,1100011,1100021,1100051,1100125,1100143,1100259,1100259,1100265,1100277,1100277,1100304,1100392,1100394,1100403,1100416,1100417,1100450,1100481,1100559,1100559,1100573,1100608,1100749,1100845,1100845,1100869,1100965,1100990,1101050,1101071,1101083,1101095,1101095,1101111,1101116,1101255,1101273,1101310,1101310,1101313,1101332,1101348,1101358,1101364,1101485,1101512,1101519,1101521,1101527,1101538,1101556,1101607,1101607,1101626,1101626,1101831,1101842,1101948,1101959,1101976,1102005,1102020,1102022,1102058,1102114,1102134,1102239,1102243,1102249,1102261,1102301,1102338,1102360,1102396,1102431,1102433,1102433,1102435,1102449,1102460,1102489,1102529,1102536,1102588,1102588,1102623,1102657,1102661,1102712,1102759,1102766,1102770,1102801,1102837,1102850,1102881,1102909,1102927,1102929,1102931,1102949,1102957,1103022,1103023,1103049,1103056,1103179,1103190,1103253,1103260,1103267,1103267,1103273,1103290,1103300,1103314,1103316,1103321,1103326,1103344,1103346,1103346,1103356,1103465,1103465,1103511,1103520,1103522,1103522,1103609,1103644,1103669,1103725,1103731,1103732,1103739,1103747,1103836,1103896,1103901,1103935,1103955,1103980,1103997,1103999,1104042,1104152,1104153,1104251,1104287,1104324,1104395,1104408,1104425,1104484,1104491,1104616,1104699,1104715,1104723,1104746,1104833,1104871,1104911,1104917,1104951,1104956,1104981,1104986,1104989,1105015,1105017,1105022,1105033,1105033,1105043,1105052,1105052,1105056,1105056,1105069,1105070,1105085,1105086,1105174,1105210,1105213,1105254,1105278,1105319,1105319,1105321,1105343,1105391,1105417,1105417,1105455,1105460,1105500,1105544,1105547,1105580,1105585,1105585,1105610,1105629,1105629,1105649,1105674,1105697,1105703,1105703,1105727,1105746,1105751,1105757,1105768,1105769,1105813,1105832,1105843,1105847,1105851,1105885,1105907,1105924,1105974,1105987,1105998,1106032,1106102,1106123,1106123,1106126,1106136,1106156,1106218,1106234,1106234,1106240,1106273,1106273,1106316,1106349,1106370,1106370,1106429,1106453,1106554,1106646,1106646,1106732,1106746,1106852,1106864,1106885,1106893,1106967,1106969,1106989,1107073,1107073,1107094,1107141,1107141,1107144,1107196,1107247,1107264,1107328,1107332,1107350,1107385,1107395,1107403,1107432,1107479,1107507,1107507,1107554,1107561,1107561,1107568,1107583,1107589,1107623,1107656,1107662,1107676,1107691,1107705,1107713,1107724,1107737,1107790,1107820,1107820,1107823,1107823,1107824,1107827,1107831,1107839,1107841,1107859,1107876,1107927,1107952,1107952,1107967,1108060,1108175,1108175,1108278,1108295,1108295,1108296,1108298,1108363,1108381,1108388,1108413,1108428,1108448,1108461,1108516,1108543,1108595,1108613,1108613,1108677,1108687,1108687,1108712,1108713,1108779,1108793,1108837,1108957,1108989,1109047,1109047,1109081,1109099,1109126,1109141,1109156,1109301,1109338,1109338,1109342,1109348,1109444,1109444,1109453,1109476,1109508,1109555,1109578,1109606,1109606,1109642,1109650,1109711,1109743,1109769,1109786,1109789,1109789,1109825,1109826,1109885,1109918,1109970,1110067,1110085,1110090,1110114,1110130,1110184,1110216,1110256,1110286,1110288,1110311,1110346,1110347,1110457,1110503,1110503,1110509,1110522,1110529,1110538,1110582,1110590,1110639,1110645,1110703,1110756,1110756,1110762,1110802,1110817,1110882,1110964,1110978,1111037,1111057,1111064,1111102,1111106,1111106,1111252,1111346,1111364,1111393,1111403,1111406,1111423,1111438,1111467,1111467,1111469,1111469,1111515,1111527,1111612,1111639,1111657,1111709,1111719,1111723,1111728,1111773,1111804,1111806,1111853,1111878,1111892,1111920,1111950,1112008,1112017,1112020,1112023,1112061,1112084,1112196,1112203,1112291,1112331,1112339,1112376,1112378,1112398,1112404,1112457,1112477,1112504,1112521,1112540,1112582,1112582,1112590,1112590,1112626,1112627,1112655,1112657,1112664,1112705,1112708,1112716,1112775,1112784,1112797,1112842,1112845,1112915,1112925,1112949,1113061,1113064,1113067,1113101,1113104,1113109,1113140,1113151,1113151,1113185,1113203,1113219,1113226,1113255,1113263,1113284,1113284,1113285,1113288,1113288,1113382,1113387,1113409,1113456,1113485,1113486,1113491,1113495,1113495,1113542,1113544,1113558,1113562,1113605,1113612,1113644,1113666,1113666,1113725,1113729,1113729,1113741,1113753,1113773,1113776,1113855,1113864,1113868,1113868,1113894,1113902,1113922,1113927,1114158,1114210,1114277,1114282,1114290,1114383,1114396,1114417,1114424,1114460,1114460,1114463,1114489,1114504,1114561,1114591,1114633,1114745,1114745,1114748,1114873,1114900,1114982,1114995,1115017,1115098,1115109,1115156,1115156,1115234,1115234,1115297,1115322,1115348,1115413,1115439,1115459,1115476,1115546,1115562,1115606,1115608,1115638,1115789,1115843,1115855,1115875,1115884,1115960,1115975,1115976,1115976,1116027,1116074,1116139,1116196,1116258,1116260,1116337,1116359,1116359,1116458,1116530,1116553,1116570,1116598,1116657,1116660,1116662,1116670,1116714,1116726,1116751,1116777,1116777,1116801,1116801,1116824,1116918,1116941,1116973,1117014,1117019,1117085,1117122,1117126,1117131,1117138,1117140,1117148,1117185,1117186,1117211,1117270,1117282,1117285,1117330,1117342,1117345,1117349,1117349,1117375,1117525,1117535,1117538,1117551,1117577,1117590,1117644,1117681,1117747,1117763,1117768,1117786,1117794,1117848,1117883,1117888,1117978,1117978,1117988,1117998,1118032,1118052,1118052,1118063,1118102,1118159,1118277,1118295,1118310,1118364,1118366,1118372,1118377,1118403,1118444,1118449,1118490,1118493,1118493,1118525,1118542,1118542,1118610,1118616,1118616,1118619,1118621,1118644,1118646,1118664,1118674,1118727,1118727,1118773,1118810,1118840,1118850,1118916,1118922,1118922,1118967,1118995,1119061,1119071,1119076,1119105,1119139,1119168,1119304,1119341,1119399,1119423,1119423,1119499,1119540,1119541,1119562,1119613,1119619,1119626,1119626,1119671,1119791,1119819,1119841,1119845,1119879,1119907,1119939,1119956,1119995,1120005,1120063,1120090,1120102,1120113,1120124,1120148,1120192,1120193,1120199,1120250,1120354,1120355,1120355,1120372,1120447,1120505,1120505,1120597,1120608,1120616,1120628,1120640,1120644,1120654,1120755,1120755,1120820,1120878,1120920,1120927,1120927,1120949,1121062,1121101,1121105,1121129,1121202,1121202,1121216,1121284,1121300,1121325,1121325,1121331,1121344,1121398,1121561,1121629,1121630,1121665,1121666,1121670,1121739,1121757,1121817,1121817,1121832,1121871,1121920,1121949,1121955,1121978,1121989,1121992,1122008,1122049,1122052,1122062,1122063,1122086,1122139,1122139,1122142,1122155,1122173,1122173,1122183,1122183,1122206,1122206,1122243,1122269,1122320,1122330,1122366,1122472,1122475,1122475,1122484,1122489,1122497,1122574,1122579,1122613,1122689,1122720,1122734,1122799,1122801,1122805,1122823,1122851,1122900,1122964,1122994,1123034,1123044,1123080,1123102,1123122,1123126,1123127,1123173,1123187,1123195,1123224,1123243,1123257,1123262,1123267,1123304,1123314,1123328,1123328,1123346,1123381,1123385,1123402,1123455,1123492,1123496,1123540,1123540,1123613,1123636,1123665,1123672,1123762,1123796,1123800,1123854,1123869,1123870,1123926,1123946,1123956,1123973,1123973,1123975,1123991,1124127,1124127,1124193,1124219,1124219,1124241,1124268,1124358,1124463,1124508,1124512,1124519,1124523,1124524,1124541,1124589,1124589,1124609,1124644,1124644,1124673,1124704,1124717,1124753,1124833,1124853,1124896,1124936,1124981,1125012,1125035,1125038,1125048,1125075,1125273,1125312,1125375,1125376,1125383,1125409,1125462,1125485,1125487,1125521,1125530,1125536,1125556,1125684,1125686,1125686,1125693,1125693,1125717,1125735,1125743,1125751,1125752,1125752,1125771,1125803,1125803,1125808,1125833,1125833,1125841,1125848,1125877,1125893,1125896,1125912,1125943,1125949,1125949,1125966,1125995,1126007,1126017,1126075,1126084,1126084,1126118,1126216,1126216,1126222,1126281,1126283,1126291,1126300,1126300,1126433,1126438,1126504,1126523,1126550,1126578,1126581,1126625,1126637,1126675,1126738,1126784,1126791,1126806,1126806,1126808,1126863,1126965,1126980,1126983,1126997,1127044,1127046,1127049,1127119,1127126,1127187,1127194,1127209,1127209,1127236,1127245,1127255,1127262,1127306,1127397,1127431,1127488,1127631,1127633,1127725,1127796,1127816,1127899,1127929,1127952,1127977,1128042,1128090,1128141,1128255,1128267,1128354,1128355,1128367,1128436,1128437,1128497,1128527,1128533,1128565,1128718,1128809,1128858,1128873,1128881,1128884,1128892,1128892,1128926,1128929,1128936,1129006,1129019,1129054,1129180,1129187,1129239,1129264,1129282,1129282,1129332,1129348,1129381,1129502,1129534,1129633,1129661,1129662,1129667,1129708,1129712,1129723,1129776,1129904,1129973,1129974,1130010,1130166,1130188,1130188,1130196,1130196,1130254,1130255,1130299,1130306,1130353,1130384,1130419,1130424,1130445,1130461,1130473,1130490,1130490,1130491,1130700,1130761,1130880,1130988,1131013,1131066,1131114,1131125,1131141,1131154,1131261,1131350,1131350,1131378,1131389,1131425,1131501,1131623,1131655,1131655,1131658,1131716,1131790,1131850,1131969,1132022,1132048,1132065,1132065,1132097,1132122,1132201,1132203,1132204,1132205,1132208,1132237,1132397,1132422,1132476,1132532,1132566,1132623,1132642,1132689,1132780,1132794,1132794,1132854,1132882,1133023,1133034,1133111,1133120,1133174,1133174,1133179,1133206,1133269,1133286,1133295,1133306,1133354,1133373,1133396,1133398,1133408,1133558,1133586,1133667,1133739,1133793,1133825,1133912,1133936,1134057,1134064,1134064,1134081,1134163,1134205,1134205,1134266,1134421,1134421,1134449,1134451,1134492,1134494,1134513,1134516,1134524,1134579,1134580,1134593,1134680,1134693,1134703,1134729,1134811,1134859,1134948,1134949,1134973,1134979,1134988,1134988,1134995,1135007,1135017,1135056,1135068,1135107,1135111,1135148,1135153,1135156,1135165,1135182,1135296,1135297,1135314,1135353,1135353,1135354,1135375,1135395,1135395,1135477,1135484,1135495,1135565,1135601,1135640,1135695,1135723,1135930,1136034,1136041,1136077,1136115,1136133,1136151,1136151,1136156,1136163,1136163,1136213,1136228,1136264,1136324,1136419,1136468,1136470,1136530,1136558,1136621,1136642,1136674,1136727,1136729,1136742,1136787,1136815,1136843,1136853,1136853,1136855,1136870,1136875,1136894,1136896,1136905,1136917,1136986,1137086,1137110,1137111,1137163,1137167,1137167,1137204,1137208,1137209,1137273,1137298,1137298,1137380,1137389,1137398,1137401,1137415,1137421,1137428,1137435,1137453,1137454,1137455,1137456,1137457,1137458,1137462,1137463,1137463,,1137470,1137471,1137476,1137481,1137491,1137492,1137494,1137495,1137496,1137497,1137497,1137498,1137506,1137512,1137517,1137520,1137527,1137530,1137531,1137536,1137537,1137540,1137541,1137542,1137548,1137560,1137566,1137586,1137604,1137675,1137811,1137875,1137932,1137948,1138057,1138086,1138091,1138093,1138117,1138119,1138119,1138143,1138145,1138186,1138207,1138210,1138223,1138230,1138230,1138287,1138311,1138337,1138342,1138450,1138450,1138466,1138571,1138585,1138585,1138587,1138622,1138672,1138764,1138785,1138807,1138865,1138865,1138876,1138896,1138943,1138976,1139000,1139022,1139034,1139037,1139086,1139109,1139224,1139228,1139229,1139229,1139250,1139257,1139257,1139261,1139282,1139307,1139314,1139315,1139317,1139335,1139349,1139367,1139370,1139422,1139440,1139462,1139470,1139527,1139533,1139537,1139547,1139588,1139588,1139656,1139717,1139726,1139733,1139778,1139800,1139806,1139806,1139823,1139823,1139841,1139851,1139854,1139865,1139891,1139922,1139969,1139975,1140041,1140062,1140097,1140189,1140192,1140213,1140276,1140276,1140278,1140357,1140358,1140372,1140375,1140386,1140408,1140408,1140413,1140431,1140572,1140603,1140637,1140665,1140672,1140676,1140679,1140791,1140807,1140833,1140841,1140844,1140852,1140855,1140863,1140890,1140898,1140900,1140911,1140914,1140930,1140935,1140947,1140954,1140962,1140978,1140989,1141018,1141021,1141067,1141077,1141124,1141143,1141201,1141216,1141216,1141289,1141329,1141333,1141365,1141403,1141406,1141415,1141423,1141583,1141622,1141689,1141691,1141758,1141784,1141823,1141852,1141925,1141934,1141998,1142048,1142103,1142109,1142111,1142123,1142149,1142154,1142294,1142382,1142404,1142426,1142529,1142577,1142582,1142608,1142660,1142788,1142817,1142824,1142824,1142839,1142958,1143023,1143067,1143086,1143101,1143118,1143138,1143152,1143181,1143210,1143235,1143423,1143447,1143510,1143510,1143518,1143558,1143614,1143614,1143654,1143755,1143848,1143905,1143960,1144022,1144035,1144474,1144535,1144798,1144820,1145192,1145400,1146542,1146710,1147280,1147445,1147449,1149240,1150064";
// SET 3
$char_string = "200719,201081,201321,201476,201480,201555,201911,202110,202151,202210,202918,203048,203429,203520,203521,203644,203653,203787,204330,204828,204963,205096,205177,205220,205366,205395,205533,205563,205594,205629,205658,205769,205846,205858,205907,205913,206002,206061,206123,206186,206219,206222,206243,206394,206451,206454,206495,206504,206524,206563,206601,206602,206611,206621,206658,206780,206807,206860,206862,206882,206883,206925,207005,207031,207037,207043,207060,207076,207100,207164,207237,207238,207275,207314,207316,207318,207326,207360,207493,207497,207499,207544,207610,207711,207720,207736,207740,207773,207782,207790,207812,207823,207890,207893,207939,207994,208076,208078,208123,208178,208215,208217,208223,208228,208231,208443,208446,208520,208607,208673,208701,208724,208728,208731,208734,208741,208743,208745,208791,208858,208882,208925,208944,209015,209078,209131,209169,209174,209200,209208,209230,209259,209261,209283,209299,209302,209376,209425,209480,209603,209617,209631,209642,209691,209706,209776,209777,209782,209850,209961,209978,210029,210031,210037,210063,210065,210066,210119,210161,210163,210169,210183,210252,210291,210310,210443,210504,210508,210531,210558,210566,210639,210667,210729,210760,210794,210807,210829,210920,211014,211058,211091,211136,211161,211200,211211,211234,211235,211239,211351,211415,211540,211585,211645,211659,211756,211775,211777,211850,211869,211884,211934,211953,212034,212059,212143,212208,212325,212330,212331,212342,212424,212479,212481,212517,212563,212667,212744,212755,212808,212810,212828,212992,213121,213224,213227,213251,213252,213280,213422,213463,213513,213782,213890,214005,214011,214212,214339,214364,214379,214479,214648,214779,214927,214929,215174,215199,215468,215551,215575,215863,215869,216032,216066,216082,216092,216219,216227,216250,216291,216401,216613,216647,216652,216726,216825,216865,216873,217307,217484,217652,217868,218084,218093,218159,218186,218401,218506,218626,218627,218633,218711,218742,218795,218808,218895,218931,218951,218992,219031,219046,219055,219099,219163,219171,219260,219278,219279,219432,219763,219830,219858,219952,220085,220124,220151,220239,220331,220467,220506,220509,220592,220690,220716,220797,220798,220857,220949,221124,221284,221462,221538,221594,221605,221819,221888,221958,222014,222041,222212,222377,222407,222436,222533,222621,222655,222673,222742,222814,222879,222930,223007,223066,223106,223262,223318,223485,223660,223798,223849,223852,223882,224168,224223,224337,224392,224469,224571,225087,225151,225342,225348,225356,225751,225838,225874,225910,225920,225922,225971,225979,226063,226064,226171,226226,226227,226334,226446,226545,226587,226684,226686,226745,226748,226864,227033,227166,227169,227350,227523,227638,227689,227720,227848,227864,227931,227938,227994,228037,228064,228089,228235,228248,228383,228636,228824,229226,229229,229325,229394,229396,229476,229545,229571,229642,229663,229665,229685,229771,229945,230011,230102,230160,230165,230260,230347,230407,230538,230652,230708,230729,230750,230791,230822,230902,231060,231144,231192,231239,231242,231322,231508,231670,231748,231920,232177,232190,232223,232387,232391,232402,232411,232421,232478,232492,232548,232567,232580,232633,232651,232666,232667,232670,232759,232822,232862,232931,232986,233082,233131,233140,233176,233280,233392,233467,233480,233699,233700,233705,233742,233748,233782,233801,233809,233838,233872,233977,234025,234091,234092,234168,234184,234229,234239,234252,234307,311780,311793,311871,311872,311874,311945,311997,312008,312010,312025,312028,312033,312034,312035,312038,312041,312046,312051,312052,312054,312056,312057,312058,312060,312063,312064,312067,312068,312069,312070,312072,312077,312079,312080,312081,312082,312084,312085,312090,312092,312101,312160,312162,312175,312278,312286,312425,312578,312590,312591,312593,312612,312613,312621,312629,312637,312638,312640,312641,312646,312647,312648,312653,312669,312670,312671,312677,312699,312714,312715,312716,312717,312718,312720,312721,312722,312724,312725,312726,312727,312728,312732,312733,312734,312737,312738,312739,312745,312747,312748,312751,312753,312762,312765,312766,312774,312778,312800,312803,312819,312821,312825,312826,312828,312832,312855,312856,312865,312871,312873,312878,312894,312907,312923,312930,312951,312953,312979,312987,313000,313001,313007,313008,313013,313014,313015,313021,313024,313035,313069,313070,313080,313087,313115,313120,313123,313139,313153,313164,313185,313219,313223,313329,313343,313364,313392,313412,313429,313497,313512,313582,313604,313609,313612,313615,313690,313697,313708,313719,313728,313743,313750,313757,313763,313766,313816,313838,313865,313869,313909,313983,313996,313999,314137,314176,314229,314246,325003,325018,325023,325028,325043,325064,325073,325104,325120,326021,326180,326227,326279,326340,326392,326508,326550,326567,326568,326652,326654,326691,326712,326730,326853,326901,326915,326917,326926,326940,327000,327113,327114,327206,327279,327342,327354,327357,327384,327412,327421,327446,327461,327489,327522,327553,327816,327880,327889,328044,328154,328158,328185,328206,328347,328434,328659,328729,500210,500408,500640,500813,501038,501388,501841,501935,501953,502203,502224,502242,502259,502421,502473,502592,502742,502791,503045,503386,503456,503535,503597,503675,503717,503975,503982,504011,504094,504302,504473,504481,504491,504542,504620,504645,504899,504913,504948,504949,505002,505262,505609,505630,505728,505813,506076,506120,506276,506402,506791,506907,507070,507162,507221,507245,507354,507478,507573,507857,508300,508450,508470,508579,508617,508829,508943,508985,509014,509053,509060,509119,509294,509300,509551,509759,510033,510406,510493,510520,510643,510667,510809,510824,510842,510904,511009,511141,511149,511179,511213,511265,511592,511619,511712,511726,511800,511851,511868,512021,512186,512387,512394,512719,512875,512892,512907,512912,512976,512987,512992,513031,513063,513149,513180,513238,513400,513534,513615,513645,513646,513771,513814,514080,514108,514184,514311,514407,514418,514595,514719,514726,514727,514769,514779,514829,514972,514999,515060,515095,515104,515150,515154,515268,515300,515445,515473,515516,515517,515591,515595,515652,515668,515691,515755,515902,515943,516287,516289,516351,516466,516484,516557,516612,516673,516729,516835,516872,516877,516898,516997,517077,517090,517144,517149,517152,517303,517325,517356,517523,517656,517663,517722,517738,517742,517753,517766,517845,517893,517902,517919,517954,518009,518048,518076,518081,518154,518177,518211,518325,518392,518394,518473,518591,518608,518610,518632,518704,518713,518801,518889,518905,519012,519138,519259,519278,519332,519357,519382,519405,519443,519540,519639,519650,519659,519767,519783,519835,519846,519889,519916,519931,519996,521476,523503,524481,525616,525744,525754,525759,525761,525774,525775,525785,525915,525918,525919,525920,525922,525925,525928,525929,525930,525931,525934,525935,525938,526088,526090,526139,526144,526602,526609,526611,526615,526631,526632,526636,526682,526685,526702,526973,526980,527036,527038,527177,527179,527180,527276,527369,527377,527386,527513,527521,527552,527578,527598,527599,527611,527620,527859,528066,528143,528151,528152,528234,528384,528405,528407,528409,528411,528413,528417,528418,528419,528420,528561,528612,528616,528617,528618,528752,528771,528774,528784,528785,528805,528892,528940,528956,528959,528961,528966,528967,528979,528981,529036,529051,529111,529113,529132,529205,529206,529216,529280,529281,529319,529335,529336,529381,529386,529420,529438,529538,529540,529577,529579,529584,529675,529686,529820,529834,529909,532262,532295,532341,532362,700055,700121,700269,700272,700314,700356,700370,700405,700409,700426,700510,700520,700586,700636,700638,700717,700731,700738,700788,700808,700859,700862,700880,700929,700938,700985,700993,701075,701078,701123,701132,701260,701294,701310,701331,701376,701413,701458,701484,701623,701638,701697,701770,701772,701798,701834,701896,701912,702019,702230,702269,702290,702314,702427,702494,702502,702559,702584,702589,702622,702632,702654,702781,702800,702801,702871,702885,702916,702917,703002,703009,703074,703130,703163,703194,800058,800065,800066,800067,800086,800122,800158,800238,800262,800284,800299,800329,800365,800512,800517,800529,800579,800614,800630,800673,800684,800733,800760,800797,800904,800987,801013,801035,801077,801081,801122,801130,801169,801259,801271,801343,801349,801355,801360,801395,801456,801465,801571,801594,801596,801606,801617,801637,801924,801945,801965,801967,802000,802013,802038,802047,802108,802133,802142,802145,802186,802188,802196,802285,802306,802353,802364,802384,802385,802427,802456,802559,802576,802642,802682,802725,802757,802868,802872,802942,802956,802976,803007,803016,803024,803026,803042,803052,803118,803125,803153,803174,803179,803244,803280,803286,803392,803428,803431,803442,803480,803529,803577,803602,803655,803680,803696,803716,803725,803766,803779,803793,900039,900128,900202,900215,900280,900308,900328,900347,900542,900560,900565,900633,1000182,1000190,1000290,1000328,1000340,1000381,1000388,1000392,1000412,1000413,1000414,1000487,1000566,1000580,1000601,1000649,1000653,1000698,1000739,1000792,1000830,1000851,1000888,1000889,1000934,1000981,1001027,1001041,1001043,1001047,1001051,1001064,1001127,1001191,1001198,1001204,1001211,1001232,1001233,1001291,1001346,1001347,1001349,1001361,1001363,1001390,1001463,1001565,1001582,1001586,1001635,1001653,1001698,1001701,1001704,1001751,1001813,1001817,1001839,1001885,1001923,1001957,1002020,1002032,1002059,1002141,1002148,1002167,1002187,1002212,1002222,1002224,1002398,1002459,1002462,1002482,1002647,1002700,1002722,1002727,1002775,1002856,1002878,1002973,1002990,1003023,1003042,1003061,1003230,1003314,1003323,1003345,1003366,1003426,1003462,1003476,1003603,1003627,1003675,1003688,1003779,1003825,1003859,1003898,1003903,1003906,1004005,1004058,1004062,1004087,1004103,1004122,1004132,1004253,1004255,1004343,1004375,1004431,1004432,1004477,1004490,1004537,1004630,1004774,1004963,1005075,1005124,1005165,1005208,1005302,1005541,1005555,1005671,1005733,1005735,1005776,1005994,1006015,1006024,1006411,1006504,1006726,1006811,1006826,1006927,1007002,1007183,1007270,1007317,1007348,1007487,1007625,1007781,1007810,1007820,1007871,1007878,1007918,1008141,1008195,1008196,1008537,1008587,1008796,1008926,1009195,1009755,1009819,1009955,1010166,1010167,1010187,1010203,1010421,1010444,1010450,1010541,1010546,1010576,1010796,1010930,1010942,1010943,1010973,1011056,1011102,1011117,1011133,1011220,1011222,1011290,1011435,1011495,1011672,1011712,1012053,1012131,1012200,1012361,1012369,1012485,1012507,1012566,1012615,1012690,1012691,1012743,1012788,1012804,1012890,1012924,1013025,1013037,1013060,1013061,1013084,1013152,1013242,1013819,1013838,1013887,1013945,1014051,1014256,1014274,1014305,1014576,1014651,1014681,1014697,1014705,1014792,1014798,1014851,1014862,1014889,1014891,1014986,1015054,1015059,1015229,1015243,1015324,1015408,1015449,1015485,1015581,1015665,1015716,1015788,1015793,1015941,1015988,1016437,1016532,1016538,1016599,1016630,1016676,1016895,1016968,1016972,1017247,1017255,1017336,1017406,1017481,1017482,1017501,1017504,1017658,1017706,1017777,1017780,1017814,1017853,1017893,1017932,1017938,1018463,1018517,1018643,1018815,1018832,1018889,1018963,1018973,1019005,1019299,1019663,1019682,1019915,1019969,1020027,1020101,1020192,1020240,1020313,1020419,1020488,1020558,1020565,1020633,1020758,1020826,1021017,1021086,1021367,1021457,1021586,1022119,1022320,1022427,1022471,1022680,1022689,1022754,1022991,1023311,1023376,1023384,1023407,1023523,1023552,1023576,1023730,1023929,1024034,1024036,1024119,1024148,1024546,1024741,1024774,1024806,1024811,1024838,1024904,1024910,1024945,1024948,1025387,1025395,1025442,1025852,1025961,1025967,1025988,1026148,1026475,1026483,1026487,1026493,1026588,1026706,1026822,1026927,1027026,1027201,1027553,1027599,1027832,1027932,1028125,1028260,1028281,1029161,1029318,1029448,1029450,1030406,1030476,1030623,1030782,1030884,1030968,1031031,1031066,1031590,1031595,1031602,1031721,1031800,1031858,1032154,1032245,1032298,1032305,1032476,1032478,1032490,1032491,1032846,1033059,1034245,1034510,1034750,1034808,1034961,1035072,1035083,1035089,1035252,1035401,1035444,1035524,1035600,1035628,1035804,1035805,1035806,1035820,1036232,1036354,1036450,1036460,1036733,1037072,1037084,1037104,1037116,1037154,1037188,1037771,1037868,1038116,1038161,1038483,1038543,1038563,1038566,1038765,1038860,1038862,1039086,1039236,1039255,1039302,1039386,1039397,1039404,1039417,1039443,1039520,1039709,1039885,1039958,1040094,1040170,1040286,1040330,1040370,1040419,1040422,1040482,1040487,1040496,1040510,1040519,1040583,1040590,1040654,1040679,1040713,1040756,1040832,1040860,1040904,1040942,1040962,1041000,1041220,1041237,1041257,1041258,1041486,1041617,1041653,1041712,1041855,1041923,1041924,1041963,1042046,1042052,1042125,1042175,1042204,1042218,1042391,1042495,1042523,1042541,1042587,1042671,1042724,1042733,1042783,1042791,1043019,1043129,1043142,1043143,1043255,1043261,1043321,1043360,1043409,1043601,1043603,1043641,1043664,1043739,1043843,1043886,1043921,1043985,1043989,1043992,1044071,1044239,1044296,1044369,1044373,1044521,1044624,1044645,1044685,1044693,1044816,1044821,1044940,1045025,1045039,1045067,1045077,1045141,1045150,1045231,1045243,1045315,1045348,1045352,1045362,1045364,1045373,1045395,1045411,1045430,1045435,1045501,1045517,1045587,1045672,1045781,1045819,1045920,1045921,1046060,1046077,1046097,1046207,1046225,1046305,1046443,1046624,1046769,1046826,1046838,1046854,1046953,1046958,1047194,1047257,1047268,1047359,1047432,1047501,1047503,1047586,1047598,1047625,1047653,1047736,1047742,1047912,1047945,1047981,1047988,1047999,1048007,1048066,1048075,1048117,1048152,1048162,1048167,1048170,1048236,1048304,1048355,1048386,1048501,1048540,1048544,1048631,1048705,1048752,1048771,1048816,1048822,1048868,1048874,1048919,1048934,1048950,1048993,1048995,1048996,1049077,1049160,1049201,1049224,1049252,1049274,1049278,1049341,1049383,1049527,1049551,1049663,1049728,1049740,1049751,1049878,1049904,1049954,1050098,1050105,1050146,1050175,1050327,1050358,1050406,1050468,1050484,1050493,1050537,1050724,1050779,1050792,1050808,1050845,1050900,1050944,1051151,1051292,1051388,1051516,1051543,1051570,1051587,1051607,1051631,1051649,1051659,1051674,1051681,1051688,1051708,1051711,1051722,1051727,1051757,1051947,1052061,1052076,1052183,1052232,1052284,1052330,1052478,1052494,1052501,1052679,1052686,1052720,1052861,1052978,1053028,1053055,1053142,1053184,1053213,1053319,1053389,1053434,1053448,1053486,1053515,1053584,1053611,1053705,1053806,1053810,1053814,1053864,1053866,1053884,1053902,1053937,1053962,1053988,1053992,1054015,1054029,1054061,1054070,1054097,1054154,1054167,1054174,1054227,1054234,1054282,1054310,1054322,1054524,1054527,1054565,1054656,1054889,1054914,1055056,1055087,1055118,1055254,1055436,1055440,1055486,1055710,1055759,1055887,1055900,1055908,1056012,1056061,1056064,1056114,1056228,1056354,1056381,1056382,1056463,1056468,1056527,1056544,1056565,1056604,1056641,1056644,1056651,1056672,1056683,1056777,1056804,1056812,1056921,1056950,1057024,1057063,1057145,1057185,1057195,1057213,1057237,1057255,1057295,1057366,1057539,1057611,1057744,1057856,1057917,1057949,1057971,1058032,1058056,1058065,1058107,1058109,1058162,1058226,1058282,1058323,1058395,1058438,1058439,1058460,1058497,1058499,1058526,1058545,1058593,1058613,1058879,1058911,1058937,1058973,1058991,1058998,1059029,1059043,1059049,1059050,1059106,1059115,1059195,1059247,1059293,1059418,1059451,1059464,1059475,1059559,1059600,1059607,1059660,1059662,1059672,1059678,1059879,1059911,1059917,1059995,1059996,1060000,1060001,1060005,1060008,1060013,1060048,1060062,1060078,1060081,1060105,1060133,1060134,1060157,1060182,1060308,1060369,1060403,1060431,1060458,1060478,1060508,1060511,1060571,1060579,1060612,1060744,1060861,1060896,1060924,1060941,1060963,1061001,1061012,1061146,1061212,1061241,1061253,1061313,1061326,1061342,1061344,1061352,1061359,1061457,1061474,1061538,1061543,1061568,1061582,1061584,1061605,1061626,1061659,1061664,1061675,1061687,1061713,1061726,1061812,1061898,1062023,1062038,1062085,1062144,1062219,1062270,1062333,1062354,1062446,1062507,1062514,1062519,1062559,1062636,1062638,1062664,1062723,1062746,1062748,1062762,1062800,1062850,1062852,1062968,1063038,1063083,1063133,1063184,1063208,1063226,1063242,1063459,1063471,1063489,1063492,1063589,1063614,1063631,1063640,1063661,1063696,1063717,1063732,1063738,1063740,1063743,1063761,1063808,1063815,1063888,1063916,1063945,1063952,1064007,1064023,1064087,1064091,1064144,1064183,1064230,1064309,1064348,1064373,1064397,1064450,1064470,1064522,1064598,1064635,1064738,1064758,1064823,1064848,1065021,1065068,1065423,1065427,1065494,1065510,1065512,1065586,1065669,1065745,1065794,1065829,1065846,1065875,1065924,1065972,1065995,1066184,1066272,1066420,1066532,1066584,1066592,1066611,1066749,1066751,1066776,1066806,1066825,1066832,1066905,1066916,1066919,1066927,1066948,1066963,1066994,1067124,1067125,1067197,1067270,1067314,1067316,1067418,1067535,1067572,1067653,1067673,1067723,1067783,1067869,1067881,1067883,1067884,1067885,1067888,1067908,1068046,1068064,1068176,1068204,1068256,1068298,1068303,1068325,1068350,1068393,1068395,1068445,1068496,1068518,1068532,1068550,1068565,1068617,1068634,1068643,1068661,1068724,1068824,1068839,1068841,1068844,1068850,1068852,1068887,1068896,1068911,1068964,1068990,1069048,1069085,1069087,1069180,1069182,1069204,1069229,1069256,1069284,1069424,1069428,1069485,1069498,1069548,1069557,1069677,1069722,1069736,1069810,1069833,1069912,1069937,1069942,1069957,1069969,1070013,1070028,1070112,1070210,1070227,1070267,1070389,1070468,1070553,1070556,1070582,1070607,1070668,1070684,1070780,1070856,1070858,1070891,1070904,1070906,1070914,1071038,1071058,1071097,1071234,1071297,1071298,1071363,1071424,1071434,1071487,1071494,1071609,1071613,1071659,1071662,1071684,1071737,1071752,1071766,1071997,1072029,1072035,1072052,1072117,1072199,1072200,1072216,1072270,1072294,1072334,1072376,1072393,1072394,1072442,1072490,1072539,1072583,1072590,1072612,1072645,1072696,1072706,1072833,1072903,1072998,1073139,1073231,1073238,1073254,1073332,1073334,1073396,1073437,1073464,1073513,1073522,1073862,1073877,1073880,1073891,1073896,1073926,1073956,1074008,1074036,1074047,1074071,1074114,1074401,1074481,1074516,1074539,1074541,1074546,1074558,1074571,1074574,1074578,1074583,1074613,1074648,1074655,1074684,1074701,1074713,1074794,1074808,1074840,1074850,1074857,1074874,1074891,1074930,1074937,1074954,1074958,1074977,1074983,1075009,1075015,1075028,1075032,1075040,1075118,1075120,1075125,1075180,1075268,1075308,1075317,1075371,1075389,1075429,1075437,1075464,1075525,1075597,1075601,1075641,1075648,1075650,1075653,1075698,1075705,1075741,1075749,1075780,1075931,1075947,1075954,1075995,1076154,1076235,1076251,1076317,1076329,1076356,1076380,1076414,1076434,1076456,1076476,1076483,1076484,1076494,1076497,1076498,1076527,1076579,1076618,1076630,1076658,1076660,1076681,1076690,1076722,1076774,1076822,1076886,1076926,1076940,1076958,1076999,1077004,1077006,1077017,1077039,1077083,1077089,1077097,1077106,1077216,1077234,1077265,1077339,1077444,1077561,1077573,1077588,1077595,1077638,1077722,1077806,1077821,1077889,1077913,1077959,1077998,1078009,1078127,1078154,1078179,1078201,1078207,1078275,1078287,1078326,1078360,1078394,1078461,1078488,1078489,1078496,1078508,1078539,1078595,1078666,1078685,1078728,1078945,1078956,1078969,1079020,1079049,1079074,1079101,1079124,1079214,1079309,1079327,1079358,1079385,1079392,1079456,1079501,1079552,1079555,1079570,1079573,1079576,1079584,1079599,1079638,1079639,1079647,1079666,1079675,1079691,1079718,1079727,1079752,1079754,1079764,1079770,1079773,1079785,1079796,1079797,1079831,1079836,1079949,1079966,1079968,1079969,1080111,1080137,1080154,1080185,1080186,1080235,1080254,1080319,1080321,1080385,1080418,1080462,1080508,1080540,1080543,1080545,1080567,1080641,1080672,1080679,1080720,1080751,1080784,1080834,1080837,1080883,1080926,1080941,1080953,1080999,1081009,1081014,1081028,1081116,1081144,1081148,1081156,1081182,1081228,1081229,1081249,1081384,1081406,1081420,1081455,1081462,1081467,1081586,1081639,1081658,1081666,1081688,1081695,1081749,1081753,1081766,1081784,1081807,1081809,1081840,1081849,1081875,1081898,1081902,1081949,1081992,1082016,1082058,1082137,1082139,1082158,1082163,1082193,1082243,1082340,1082375,1082450,1082472,1082565,1082599,1082658,1082666,1082750,1082777,1082798,1082846,1082856,1082889,1082908,1082947,1082972,1083008,1083049,1083122,1083202,1083242,1083414,1083549,1083557,1083584,1083593,1083634,1083645,1083812,1083876,1083893,1083895,1083995,1084004,1084042,1084054,1084057,1084108,1084124,1084189,1084220,1084243,1084255,1084256,1084266,1084305,1084316,1084361,1084412,1084415,1084466,1084529,1084586,1084601,1084634,1084696,1084716,1084718,1084771,1084805,1084839,1084854,1084910,1084952,1084958,1084965,1085017,1085052,1085079,1085096,1085211,1085220,1085314,1085380,1085407,1085430,1085443,1085465,1085485,1085493,1085494,1085541,1085545,1085577,1085607,1085619,1085760,1085810,1085853,1085900,1085951,1085965,1086080,1086162,1086165,1086178,1086179,1086183,1086306,1086320,1086323,1086393,1086559,1086570,1086591,1086597,1086774,1086789,1086812,1086829,1086841,1086862,1086903,1086915,1086947,1086957,1086979,1086989,1086995,1087039,1087056,1087065,1087124,1087167,1087210,1087214,1087232,1087312,1087337,1087417,1087445,1087447,1087530,1087550,1087554,1087596,1087685,1087774,1087798,1087799,1087839,1087994,1087997,1088030,1088051,1088057,1088060,1088172,1088174,1088236,1088239,1088254,1088344,1088353,1088366,1088415,1088475,1088521,1088552,1088567,1088588,1088614,1088619,1088631,1088641,1088651,1088670,1088675,1088699,1088738,1088835,1088839,1088934,1088948,1089055,1089110,1089130,1089163,1089173,1089251,1089278,1089333,1089388,1089464,1089471,1089490,1089590,1089625,1089630,1089678,1089685,1089721,1089743,1089812,1089826,1089849,1089861,1089879,1089893,1089918,1089928,1089932,1089980,1090007,1090049,1090055,1090123,1090136,1090151,1090161,1090163,1090202,1090261,1090263,1090329,1090361,1090393,1090412,1090445,1090499,1090528,1090579,1090580,1090593,1090623,1090724,1090735,1090757,1090787,1090790,1090810,1090836,1090904,1090916,1090923,1090949,1090968,1090981,1091035,1091043,1091045,1091058,1091105,1091156,1091200,1091222,1091223,1091226,1091232,1091263,1091293,1091316,1091318,1091364,1091434,1091445,1091450,1091513,1091518,1091522,1091529,1091543,1091562,1091579,1091608,1091612,1091635,1091648,1091657,1091671,1091673,1091708,1091711,1091722,1091744,1091768,1091912,1091937,1091956,1091988,1092000,1092077,1092123,1092193,1092198,1092204,1092221,1092233,1092236,1092293,1092298,1092321,1092328,1092349,1092389,1092466,1092545,1092621,1092651,1092655,1092678,1092698,1092778,1092798,1092834,1092857,1092891,1092892,1092902,1092929,1092932,1092935,1092960,1092977,1093047,1093070,1093080,1093111,1093118,1093166,1093244,1093260,1093321,1093386,1093387,1093401,1093419,1093434,1093439,1093494,1093528,1093554,1093577,1093609,1093624,1093653,1093672,1093702,1093710,1093728,1093747,1093838,1093844,1093861,1093882,1093910,1093914,1093927,1093989,1094012,1094095,1094097,1094112,1094130,1094247,1094467,1094536,1094586,1094602,1094652,1094668,1094681,1094878,1094905,1094977,1095050,1095057,1095067,1095103,1095118,1074619";

$char_numbers_arr = explode(',', $char_string);
$char_numbers_arr = array_unique($char_numbers_arr);

function get_each_charity ($char_num) {
    // --- get page
    $scraped_page = curl("http://www.charitycommission.gov.uk/Showcharity/RegisterOfCharities/ContactAndTrustees.aspx?RegisteredCharityNumber=".$char_num."&SubsidiaryNumber=0");    // Downloading page to variable $scraped_page

    // get charity name
    $scraped_title = scrape_between($scraped_page, '<div id="ctl00_charityStatus_spnCharityName" class="StatusCharityName">', '</div>');
    // clean charity name
    $scraped_title = trim($scraped_title);

    // --- get refined details
    $scraped_contact_name = scrape_between($scraped_page, '<span id="ctl00_MainContent_ucDisplay_ucContactDetails_lblContactName" class="ContactAddress">', '</span>');
    $scraped_contact_addy1 = scrape_between($scraped_page, '<span id="ctl00_MainContent_ucDisplay_ucContactDetails_lblAddressLine1" class="ContactAddress">', '</span>');
    $scraped_contact_addy2 = scrape_between($scraped_page, '<span id="ctl00_MainContent_ucDisplay_ucContactDetails_lblAddressLine2" class="ContactAddress">', '</span>');
    $scraped_contact_addy3 = scrape_between($scraped_page, '<span id="ctl00_MainContent_ucDisplay_ucContactDetails_lblAddressLine3" class="ContactAddress">', '</span>');
    $scraped_contact_addy4 = scrape_between($scraped_page, '<span id="ctl00_MainContent_ucDisplay_ucContactDetails_lblAddressLine4" class="ContactAddress">', '</span>');
    $scraped_contact_addy5 = scrape_between($scraped_page, '<span id="ctl00_MainContent_ucDisplay_ucContactDetails_lblAddressLine5" class="ContactAddress">', '</span>');
    $scraped_contact_addy6 = scrape_between($scraped_page, '<span id="ctl00_MainContent_ucDisplay_ucContactDetails_lblAddressLine6" class="ContactAddress">', '</span>');
    $scraped_address = trim($scraped_contact_addy1).', '.trim($scraped_contact_addy2).', '.trim($scraped_contact_addy3).', '.trim($scraped_contact_addy4).', '.trim($scraped_contact_addy5).', '.trim($scraped_contact_addy6);
    // remove last comma if apply for partial address
    $scraped_address = rtrim($scraped_address, ',');
    $scraped_address = rtrim($scraped_address, ', ');
    $scraped_address = rtrim($scraped_address, ', ,');
    $scraped_address = rtrim($scraped_address, ', , ');

    $full_scraped_address = trim($scraped_contact_name).', '.trim($scraped_contact_addy1).', '.trim($scraped_contact_addy2).', '.trim($scraped_contact_addy3).', '.trim($scraped_contact_addy4).', '.trim($scraped_contact_addy5).', '.trim($scraped_contact_addy6);
    // remove last comma if apply for full address
    $full_scraped_address = rtrim($full_scraped_address, ',');
    $full_scraped_address = rtrim($full_scraped_address, ', ');
    $full_scraped_address = rtrim($full_scraped_address, ', ,');
    $full_scraped_address = rtrim($full_scraped_address, ', , ');


    // get refined contact details
    // get telephone number
    $scraped_telephone_number = scrape_between($scraped_page, '<span id="ctl00_MainContent_ucDisplay_ucContactDetails_lblPhone" class="ContactDetailsLabel">', '</span>');
    // Get email
    $scraped_email = scrape_between($scraped_page, '<a id="ctl00_MainContent_ucDisplay_ucContactDetails_hlEmail" class="ContactDetailsLabel">', '</a>');
    // clean email as its obfuscated
    $scraped_email = html_entity_decode($scraped_email);
    // get website
    $scraped_website = scrape_between($scraped_page, '<a id="ctl00_MainContent_ucDisplay_ucContactDetails_hlWebsite" title="', '"');

    $build_for_excel = $char_num."\t".strip_tags($scraped_title)."\t".$scraped_contact_name."\t".$scraped_address."\t".trim(str_replace('Tel:','',$scraped_telephone_number))."\t".$scraped_email."\t".$scraped_website."\t".$full_scraped_address."\n";
    echo $build_for_excel;
}

foreach ($char_numbers_arr as $char_num){
    get_each_charity($char_num);
    sleep(1);
}
?>